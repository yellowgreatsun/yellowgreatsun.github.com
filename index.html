<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  

  
  <title>抹香随笔</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="抹香君的学习之路与修行之路。">
<meta name="keywords" content="随笔">
<meta property="og:type" content="website">
<meta property="og:title" content="抹香随笔">
<meta property="og:url" content="https://moxiangessay.com/index.html">
<meta property="og:site_name" content="抹香随笔">
<meta property="og:description" content="抹香君的学习之路与修行之路。">
<meta property="og:locale" content="zh">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="抹香随笔">
<meta name="twitter:description" content="抹香君的学习之路与修行之路。">
  
    <link rel="alternate" href="/atom.xml" title="抹香随笔" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">抹香随笔</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">醉舞经阁半卷书，坐井说天阔。</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://moxiangessay.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-《爱的艺术》读书笔记千字版——努力发展自己的生命力，并真诚地与他人分享自己的生命力" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/02/26/《爱的艺术》读书笔记千字版——努力发展自己的生命力，并真诚地与他人分享自己的生命力/" class="article-date">
  <time datetime="2019-02-26T15:24:52.591Z" itemprop="datePublished">2019-02-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/02/26/《爱的艺术》读书笔记千字版——努力发展自己的生命力，并真诚地与他人分享自己的生命力/">《爱的艺术》读书笔记千字版——努力发展自己的生命力，并真诚地与他人分享自己的生命力</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>《爱的艺术》作者：弗洛姆</p>
<h3 id="爱的主体？"><a href="#爱的主体？" class="headerlink" title="爱的主体？"></a>爱的主体？</h3><p>爱的主体是人，那么什么是人呢？我认为基于三点：<br>一是生物学和精神个体，表现为生长发育、智力成长和心灵修行。<br>二是社会关系，表现为社会组织和人际交往。<br>三是自然关系，表现为法自然，或称天人合一。<br>一个健全的人，就是处理好、协调好上述三种关系的人。</p>
<h3 id="什么是爱？"><a href="#什么是爱？" class="headerlink" title="什么是爱？"></a>什么是爱？</h3><p>爱包含两个成分，一是<strong>爱内</strong>（努力发展自己的生命力），二是<strong>爱外</strong>（真诚地与他人分享自己的生命力）。爱体现在三个维度，即身体、心态、灵魂。</p>
<ul>
<li><p><strong>爱内</strong>，就是要在意识到自己的独立性和完整性的基础上，发展自己的生命力和创造力，也即对<em>“我是谁？我从哪里来？我要到哪里去？”</em>的求索和追求。</p>
</li>
<li><p><strong>爱外</strong>，也是在意识到自己、他人（一切外的统称）的独立性和完整性的基础上，发自内心地彼此分享彼此的生命力。无论这个外，是朝夕相处，还是萍水相逢，甚至是花鸟虫鱼。</p>
</li>
</ul>
<p>爱的三个维度，即<strong>身体、心态、灵魂</strong>，对应的几个词汇分别是<strong>健康、愉悦、幸福</strong>。</p>
<h3 id="为什么需要爱？"><a href="#为什么需要爱？" class="headerlink" title="为什么需要爱？"></a>为什么需要爱？</h3><ul>
<li><p>爱是人本然的向往，我们都希望自己和他人活得健康、活得愉悦、活得幸福。既希望自己和他人作为个体是充满爱的，也希望彼此之间的关系是充满爱的。</p>
</li>
<li><p>成长（或者说生存）的需求，以人的生存作为前提，主要体现在克服孤寂、认识“人的秘密”、阴阳结合三个方面。对人类存在问题的真正和全面的回答是要在爱中实现人与人之间的统一。</p>
</li>
<li><p>社会进化的需求，惟有爱才能促进社会的良性发展，才能实现真正的和全面的人与人之间的统一。</p>
</li>
</ul>
<h3 id="爱是一项艺术吗？"><a href="#爱是一项艺术吗？" class="headerlink" title="爱是一项艺术吗？"></a>爱是一项艺术吗？</h3><p>爱是一门艺术，要求想要掌握这门艺术的人有这方面的知识并付出努力。爱是人格整体的展观，要发展爱的能力，就需要努力发展自己的人格，并朝着有益的目标迈进。</p>
<h2 id="爱的质料"><a href="#爱的质料" class="headerlink" title="爱的质料"></a>爱的质料</h2><p><strong>给、关心、尊重、责任、了解</strong></p>
<ul>
<li><p>给作为“爱”的核心要素，“给”就是真诚地与人分享。分享他的物质、欢乐、兴趣、理解力、知识、幽默和悲伤——简而言之就是一切在他身上有生命力的东西。</p>
</li>
<li><p>关心是个人对他人或自己的需求予以关注和关怀的态度。</p>
</li>
<li><p>尊重，又称接纳，一种延缓评判和实事求是地正视对方独有个性的习惯，要求从对方的角度，而非自己的参考框架去理解对方。它至少包含四个方面：绝对价值、准确同感、支持自主性、肯定。</p>
</li>
<li><p>责任并非一种义务和外部强加的东西，而是一种完全自觉的行动，是个人对自己和另一个生命表达出来或尚未表达出来的愿望（理性愿望和非理性愿望）的答复。</p>
</li>
<li><p>了解是要深入事物的内部，去探索相关的信息，而不是满足于一知半解。</p>
</li>
</ul>
<p>关心、尊重、责任和了解是相互依赖的，在成熟的人身上可以看到这些态度的集中表现。</p>
<h3 id="爱的基本形式"><a href="#爱的基本形式" class="headerlink" title="爱的基本形式"></a>爱的基本形式</h3><p><strong>博爱、母爱、情爱、自爱和神爱</strong></p>
<p>上述几种爱的基本形式主要是由于爱的对象不同。</p>
<ul>
<li><p>博爱是对所有人都具有一种关心、责任、尊重和了解，也就是愿意提升所有人的生活乐趣。</p>
</li>
<li><p>母爱是对需要帮助的孩子的生存需求和成长需求提供无条件的回应，这种无条件的回应包括“乳汁”和“蜂蜜”两个方面。母爱是无私的，与母爱不同，父爱是有条件的。</p>
</li>
<li><p>情爱是通过体验性，以及决定把自己完全交付对方的意志选择，而去发展爱的能力。情爱具有独占性，这种独占性只表现在我只同一个人在灵与肉上融汇为一体。</p>
</li>
<li><p>自爱不是利己，而是一种爱自己的能力。</p>
</li>
<li><p>神爱不是从思想上了解神，也不是在思想上了解神，而是追求神的境界，期待与神一致，因为神象征正义、公平、真理、爱。</p>
</li>
</ul>
<h3 id="爱的实践"><a href="#爱的实践" class="headerlink" title="爱的实践"></a>爱的实践</h3><ul>
<li><p>纪律、集中、耐心、极大的兴趣、间接地学会这门艺术。</p>
</li>
<li><p>克服自恋（不断培养自己的谦逊、客观性和理智）、信仰（相信自己的爱情并相信这种爱情能唤起别人的爱以及相信这种爱的可靠性、勇气）、积极的行动（人的内在的积极性，创造性地运用自己的力量）。</p>
</li>
</ul>
<h3 id="爱情匮乏的社会现实"><a href="#爱情匮乏的社会现实" class="headerlink" title="爱情匮乏的社会现实"></a>爱情匮乏的社会现实</h3><ul>
<li><p>我们经常会提到爱周围的人的宗教理想，但实际上我们的关系在最好的情况下是受到“公正”原则的制约。“你给我多少，我就给多少”，无论物品还是爱，这是资本主义道德的最高原则。</p>
</li>
<li><p>我们的社会越来越被工业官僚阶层和职业政治家所控制。人们被大众影响所左右，他们的目的是尽可能多地生产和尽可能多地消费，并把这作为自我目标。一切活动都从属于经济目标。</p>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://moxiangessay.com/2019/02/26/《爱的艺术》读书笔记千字版——努力发展自己的生命力，并真诚地与他人分享自己的生命力/" data-id="cjsncqrxf0000lifymidmcj02" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-抹香君自传" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/02/26/抹香君自传/" class="article-date">
  <time datetime="2019-02-26T15:24:52.591Z" itemprop="datePublished">2019-02-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/02/26/抹香君自传/">抹香君自传</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>抹香君不知何许人也，亦不详其姓氏，好墨香，因取其谐音为号焉。<br>为天地立心，为生民立命，为往圣立绝学，为万世开太平。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://moxiangessay.com/2019/02/26/抹香君自传/" data-id="cjsncqrxk0001lify30gnlxr5" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Android apk签名详解——AS签名、获取签名信息、系统签名、命令行签名" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/02/26/Android apk签名详解——AS签名、获取签名信息、系统签名、命令行签名/" class="article-date">
  <time datetime="2019-02-26T15:24:52.591Z" itemprop="datePublished">2019-02-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/02/26/Android apk签名详解——AS签名、获取签名信息、系统签名、命令行签名/">Android apk签名详解——AS签名、获取签名信息、系统签名、命令行签名</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Apk签名，每一个Android开发者都不陌生。它就是对我们的apk加了一个校验参数，防止apk被掉包。一开始做Android开发，就接触到了apk签名；后来在微信开放平台、高德地图等平台注册时，需要填写apk签名的md5值和sha256值；再后来做系统应用，接触到了系统签名；而后就想了解下apk的生成机制，学习了如何用命令行进行签名。很早时以为很简单的签名，真没想到也蕴含这么丰富的知识，就想整理一下，也分享给其它小伙伴们。</p>
<h3 id="文章结构："><a href="#文章结构：" class="headerlink" title="文章结构："></a>文章结构：</h3><ul>
<li>利用Android Studio生成签名与对apk进行签名</li>
<li>获取签名文件的md5值和sha256值</li>
<li>获取系统签名</li>
<li>利用命令行生成签名与对apk进行签名</li>
</ul>
<h3 id="一、利用Android-Studio生成签名与对apk进行签名"><a href="#一、利用Android-Studio生成签名与对apk进行签名" class="headerlink" title="一、利用Android Studio生成签名与对apk进行签名"></a>一、利用Android Studio生成签名与对apk进行签名</h3><p>利用Android Studio（或者Eclipse）生成签名与对apk进行签名，是最常用的签名方式。本文也就从这里开始说起。</p>
<h4 id="1-生成签名"><a href="#1-生成签名" class="headerlink" title="1.生成签名"></a>1.生成签名</h4><p>依次选择Build——Generate Signed Bundle/APK——选择apk——点击Next，会看到Key store path下面有两个按钮（如图1）。<br><img src="https://upload-images.jianshu.io/upload_images/3364201-0dd20fcdb6fbed99.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="图片1.png"><br>我们这里是要生成签名，当然选择Create New…，打开New Key Store对话框（如图2），填入指定的信息后，点击OK即可生成签名。<br><img src="https://upload-images.jianshu.io/upload_images/3364201-9e0e88dbc737994f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="图片2.png"></p>
<h4 id="2-对apk进行签名"><a href="#2-对apk进行签名" class="headerlink" title="2.对apk进行签名"></a>2.对apk进行签名</h4><p>打开Generate Signed Bundle or APK对话框后，直接选择已有的签名即可，点击Next，选择输出路径、签名版本后，点击Finish即可生成签名后的版本。</p>
<h4 id="3-Android-Studio2-2之后的V1签名和V2签名"><a href="#3-Android-Studio2-2之后的V1签名和V2签名" class="headerlink" title="3.Android Studio2.2之后的V1签名和V2签名"></a>3.Android Studio2.2之后的V1签名和V2签名</h4><p>当使用Android Studio2.2及以后版本进行签名打包时，会发现多了一个对签名版本的选择（如图3），这个V1和V2表示什么意思呢？<br><img src="https://upload-images.jianshu.io/upload_images/3364201-0c34777b344b68ba.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="图片3.png"><br>V1就是传统的签名方式，V2则是Android7.0之后引入的。其区别是，V1是通过ZIP条目进行验证，这样APK 签署后可进行许多修改；而V2验证压缩文件的所有字节，而不是单个 ZIP 条目，这样在签名后无法再更改。V2的好处很明显，更安全且验证更迅速。所以，推荐在生成apk时，签名方式选择V1+V2。当然，仅仅选择V1也是可以的。如果仅选择V2呢，这样生成的apk在Android7.0及之后的版本上没有问题，不过会导致7.0以下的版本无法安装，所以要避免这种方式。</p>
<h4 id="4-在gradle中配置签名信息"><a href="#4-在gradle中配置签名信息" class="headerlink" title="4.在gradle中配置签名信息"></a>4.在gradle中配置签名信息</h4><p>我们都知道Android使用gradle来构建版本，因此我们也希望在gradle中配置好签名信息，在打包apk时更方便。<br>在项目的build.gradle中，android下加入signingConfig信息。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">signingConfigs &#123;      </span><br><span class="line">  debug &#123;          </span><br><span class="line">    storeFile file(&quot;./hyydev.jks&quot;)          </span><br><span class="line">    storePassword &quot;******&quot;         </span><br><span class="line">     keyAlias &quot;**&quot;          </span><br><span class="line">    keyPassword &quot;******&quot;          </span><br><span class="line">    v1SigningEnabled true          </span><br><span class="line">    v2SigningEnabled true      </span><br><span class="line">  &#125;      </span><br><span class="line">  release &#123;          </span><br><span class="line">    storeFile file(&quot;./hyydev.jks&quot;)          </span><br><span class="line">    storePassword &quot;******&quot;          </span><br><span class="line">    keyAlias &quot;**&quot;          </span><br><span class="line">    keyPassword &quot;******&quot;         </span><br><span class="line">    v1SigningEnabled true          </span><br><span class="line">    v2SigningEnabled true      </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="5-jks与keystore"><a href="#5-jks与keystore" class="headerlink" title="5.jks与keystore"></a>5.jks与keystore</h4><p>从Eclipse开始做Android开发的小伙伴都知道，Eclipse默认生成的签名文件是keystore格式，而Android Studio生成的是jks格式。二者只是签名格式的不同，是可以进行转换的（如何转换，后续会专门介绍）。</p>
<h3 id="二、获取签名文件的md5值和sha256值"><a href="#二、获取签名文件的md5值和sha256值" class="headerlink" title="二、获取签名文件的md5值和sha256值"></a>二、获取签名文件的md5值和sha256值</h3><p>在文章开始时，就提到了在许多开放平台注册时，需要用到apk签名的md5值和sha256值，怎么获取呢？这里提供了两种方法。</p>
<h4 id="1-用命令行获取md5值和sha256值"><a href="#1-用命令行获取md5值和sha256值" class="headerlink" title="1.用命令行获取md5值和sha256值"></a>1.用命令行获取md5值和sha256值</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">keytool -v -list -keystore hyydev.jks</span><br></pre></td></tr></table></figure>
<p>如图4。<br><img src="https://upload-images.jianshu.io/upload_images/3364201-83d5686cef0b8fbc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="图片4.png"></p>
<h4 id="2-用代码获取md5值和sha256值"><a href="#2-用代码获取md5值和sha256值" class="headerlink" title="2.用代码获取md5值和sha256值"></a>2.用代码获取md5值和sha256值</h4><p>除了用keytool命令获取外，也可以通过代码获取签名的md5值和sha256值。<br>代码如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">public static String getSign(Context context, String packageName) &#123;        </span><br><span class="line"></span><br><span class="line">  String signValidString = &quot;&quot;;      </span><br><span class="line">  try &#123;          </span><br><span class="line">    @SuppressLint(&quot;PackageManagerGetSignatures&quot;)          </span><br><span class="line">    PackageInfo packageInfo = context.getPackageManager().getPackageInfo(packageName, PackageManager.*GET_SIGNATURES*);          </span><br><span class="line">    signValidString = *getSignValidString*(packageInfo.signatures[0].toByteArray(), &quot;MD5&quot;);  //参数可以填&quot;SHA1&quot;、&quot;SHA256&quot;      </span><br><span class="line">  &#125; catch (Exception e) &#123;      </span><br><span class="line">  &#125;      </span><br><span class="line">  return signValidString;  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line">private static String getSignValidString(byte[] paramArrayOfByte, String signType) throws NoSuchAlgorithmException &#123;</span><br><span class="line"></span><br><span class="line">  MessageDigest localMessageDigest = MessageDigest.*getInstance*(signType); </span><br><span class="line">  localMessageDigest.update(paramArrayOfByte);      </span><br><span class="line">  return *toHexString*(localMessageDigest.digest());  //转为16进制显示，实现略去  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="三、获取系统签名"><a href="#三、获取系统签名" class="headerlink" title="三、获取系统签名"></a>三、获取系统签名</h3><p>Android系统的签名信息不是keystore或jks格式，它默认存在build\target\product\security目录下（如图5）。如果需要获取系统签名的信息，需要在Ubuntu环境下把它转换为keystore或jks格式。<br><img src="https://upload-images.jianshu.io/upload_images/3364201-a656c8a10cd844c6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="图片5.png"></p>
<h4 id="1-生成keystore签名文件"><a href="#1-生成keystore签名文件" class="headerlink" title="1.生成keystore签名文件"></a>1.生成keystore签名文件</h4><p>1&gt;.取platform.pk8 platform.x509.pem放到一个目录下<br>2&gt;.生成platform.pem<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl pkcs8 -in platform.pk8 -inform DER -outform PEM -out platform.pem -nocrypt</span><br></pre></td></tr></table></figure></p>
<p>3&gt;.生成platform.p12<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">openssl pkcs12 -export -in platform.x509.pem -inkey platform.pem -out platform.pk12 -name dev </span><br><span class="line">Enter Export Password: (输入密码，比如hyydev)</span><br><span class="line">Verifying - Enter Export Password:(输入密码,比如hyydev)</span><br></pre></td></tr></table></figure></p>
<p>4&gt;.生成hyysign.keystore<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">keytool -importkeystore -deststorepass android -destkeypass hyydev -destkeystore hyysign.keystore -srckeystore platform.pk12 -srcstoretype PKCS12 -srcstorepass hyydev -alias dev</span><br></pre></td></tr></table></figure></p>
<h4 id="2-生成jks签名文件"><a href="#2-生成jks签名文件" class="headerlink" title="2.生成jks签名文件"></a>2.生成jks签名文件</h4><p>与生成keystore文件类似。<br>1&gt;.取platform.pk8 platform.x509.pem放到一个目录下<br>2&gt;.生成platform.pem文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl pkcs8 -inform DER -nocrypt -in platform.pk8 -out platform.pem</span><br></pre></td></tr></table></figure></p>
<p>3&gt;.生成platform.p12<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl pkcs12 -export -in platform.x509.pem -out platform.p12 -inkey platform.pem -password pass:hyydev -name hyy</span><br></pre></td></tr></table></figure></p>
<p>4&gt;.生成hyysign.jks<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">keytool -importkeystore -deststorepass hyydev -destkeystore hyysign.jks -srckeystore platform.p12 -srcstoretype PKCS12 -srcstorepass hyydev</span><br></pre></td></tr></table></figure></p>
<h4 id="3-哪些apk的签名必须使用系统签名文件"><a href="#3-哪些apk的签名必须使用系统签名文件" class="headerlink" title="3.哪些apk的签名必须使用系统签名文件"></a>3.哪些apk的签名必须使用系统签名文件</h4><p>有些apk需要系统权限，比如实现关机指令。<br>如何声明系统权限呢？<br>在AndroidMainfest.xml的mainfest中加入：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">android:sharedUserId=&quot;android.uid.system&quot;</span><br></pre></td></tr></table></figure></p>
<p>用到系统权限的apk，起签名必须使用系统签名，否则安装不上，会报错误（如图6）。<br><img src="https://upload-images.jianshu.io/upload_images/3364201-5c0bfc281f7d633b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="图片6.png"></p>
<h3 id="四、利用命令行生成签名与对apk进行签名"><a href="#四、利用命令行生成签名与对apk进行签名" class="headerlink" title="四、利用命令行生成签名与对apk进行签名"></a>四、利用命令行生成签名与对apk进行签名</h3><p>上面所提到的签名，都是利用IDE来生成签名、进行签名，用命令行该怎么做呢？</p>
<h4 id="1-生成签名-1"><a href="#1-生成签名-1" class="headerlink" title="1.生成签名"></a>1.生成签名</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">keytool -genkeypair -alias hyydev -keyalg RSA -validity 400 -keystore hyydev.keystore</span><br></pre></td></tr></table></figure>
<p><img src="https://upload-images.jianshu.io/upload_images/3364201-62b48a3a85c2d063.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="图片7.png"></p>
<h4 id="2-对未签名的apk进行签名"><a href="#2-对未签名的apk进行签名" class="headerlink" title="2.对未签名的apk进行签名"></a>2.对未签名的apk进行签名</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jarsigner -verbose -keystore hyydev.keystore -signedjar TestSign.apk Test.apk hyydev</span><br></pre></td></tr></table></figure>
<h4 id="3-重签名"><a href="#3-重签名" class="headerlink" title="3.重签名"></a>3.重签名</h4><p>进行重签名时，会报错java.util.zip.ZipException: invalid entry compressed size (expected 41278 but got 42575bytes) bytes)。如何解决呢？就是要重签名的apk后缀改成zip，打开后删除里面的META-INF目录，然后重新改成apk后缀，再进行签名就可以了。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://moxiangessay.com/2019/02/26/Android apk签名详解——AS签名、获取签名信息、系统签名、命令行签名/" data-id="cjsncqrxr0002lifyptky7ptf" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2019/02/26/《爱的艺术》读书笔记千字版——努力发展自己的生命力，并真诚地与他人分享自己的生命力/">《爱的艺术》读书笔记千字版——努力发展自己的生命力，并真诚地与他人分享自己的生命力</a>
          </li>
        
          <li>
            <a href="/2019/02/26/抹香君自传/">抹香君自传</a>
          </li>
        
          <li>
            <a href="/2019/02/26/Android apk签名详解——AS签名、获取签名信息、系统签名、命令行签名/">Android apk签名详解——AS签名、获取签名信息、系统签名、命令行签名</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2019 抹香君<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>